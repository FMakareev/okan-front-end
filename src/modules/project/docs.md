
# Термины

* **ячейка** - это универсальная единица контента в документе
* **раздел** - ячейка у которой `isHead == true`
* **подраздел** - ячейка у которой `isHead == true` и у нее есть родитель 
* **блок контента** - ячейка у которой `isHead == false`

# Операции:

## Создать раздел/подраздел

### Создать первый раздел 

1. выполнить `createcell` 
2. `id` созданной ячейки передать в вызов мутации `updatedocuent` в аргумент `children`
3. обновить документ в кеше, документы привязаны к запросу `projectitem`
4. переинициализировать стейт компонента `DocumentTree` 


### Создать раздел после последнего раздела 

1. выполнить `createcell` передавая в него: 
    * `isHead:true` - говорит о том что данная ячейка `раздел`; 
    * `parent` - `id` родителя, если родитеь документ то `null`;
    * `prevcell` - `id` предыдущей ячейки, если предыдущая ячейка документ то `null`.
2. найти в кеше предыдущую ячейку и записать в ее поле `nextcell` только что созданную ячейку;
3. найти в кеше родителя ячейку и записать в его поле `children` и поле `firstChildren` 
только что созданную ячейку;
4. добавить ячейку в дерево разделов компонент `DocumentTree`

### Создать раздел между разделами

1. выполнить `createcell` передавая в него: 
    * `isHead:true` - говорит о том что данная ячейка `раздел`; 
    * `parent` - `id` родителя, если родитеь документ то `null`;
    * `prevcell` - `id` предыдущей ячейки, если предыдущая ячейка документ то `null`.
2. найти в кеше предыдущую ячейку и записать в ее поле `nextcell` только что созданную ячейку;
3. найти в кеше следующую ячейку и записать в ее поле `prevcell` только что созданную ячейку;
4. добавить ячейку в дерево разделов компонент `DocumentTree`

### Создать **подраздел** у раздела без потомков

1. выполнить `createcell` передавая в него: 
    * `isHead:true` - говорит о том что данная ячейка `раздел`; 
    * `parent` - `id` родителя;
    * `prevcell` - `id` родителя.
2. найти в кеше родителя и обновить у него ссылку на `childcell` передав туда объект новой ячейки;
3. добавить ячейку в дерево разделов компонент `DocumentTree`.

### Создать создать **подраздел** в конце списка потомков если эти потомки **подразделы**

1. выполнить `createcell` передавая в него: 
    * `isHead:true` - говорит о том что данная ячейка `раздел`; 
    * `parent` - `id` родителя;
    * `prevcell` - `id` родителя, либо `id` последней дочерней ячейк родителя, получить можно из `firstChildren`.
2. найти в кеше предыдущую ячейку и записать в ее поле `nextcell` только что созданную ячейку;
3. найти в родителя и записать в его поле `firstChildren` новую ячейку;
4. добавить ячейку в дерево разделов компонент `DocumentTree`. 

### Создать **подраздел** в разделе дочерними **ячейками** которого являются **блоки контента**

1. выполнить `createsubcell` с аргументами:
    * `isHead:true` - говорит о том что данная ячейка `раздел`; 
    * `parent` - `id` родителя;
    * `prevcell` - `id` родителя, либо `id` последней дочерней ячейк родителя, получить можно из `firstChildren`.
2. найти в кеше родителя и записать в еге поле `childcell` и `firstChildren` только что созданную ячейку; 
3. найти в кеше все дочерние ячейки родителя и заменить у них ссылку `parent` на новую ячейку
4. добавить ячейку в дерево разделов компонент `DocumentTree`. 

### Создать текстовый/графический/таблицу блока

* создание текстового **блока контента**
* создание графического **блока контента**
* создание табличного **блока контента**


## Удаление 
удалить раздел
удалить подраздел
удалить текстовый/графический/таблицу блока
