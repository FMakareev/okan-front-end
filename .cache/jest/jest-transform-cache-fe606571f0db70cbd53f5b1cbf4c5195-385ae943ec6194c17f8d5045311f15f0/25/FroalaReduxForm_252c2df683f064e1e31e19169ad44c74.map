{"version":3,"sources":["FroalaReduxForm.js"],"names":["FroalaEditor","resolve","LoadingComponent","serverMode","FroalaReduxForm","props","state","initialState","handleModelChange","bind","contentType","contenttype","toolbarButtons","BLOCK_IMAGE","FROALA_BTN_TITLE_COPY","FROALA_BTN_TITLE_BIND","FROALA_BTN_TITLE_UNBIND","BLOCK_TABLE","BLOCK_TEXT","BLOCK_NAME","EditorConfig","placeholderText","theme","charCounterCount","autofocus","language","setState","nextProps","meta","error","active","touched","input","value","label","event","console","log","onChange","config","action","handleButtonClick","model","Component"],"mappings":"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","sourcesContent":["// FroalaReduxForm\r\nimport React, { Component } from 'react';\r\nimport { DefineIcons } from './DefineIcons';\r\n// Require Editor JS files.\r\nimport 'froala-editor/js/froala_editor.pkgd.min.js';\r\nimport 'froala-editor/js/languages/ru.js';\r\n\r\n// Require Editor CSS files.\r\nimport 'froala-editor/css/froala_style.min.css';\r\nimport 'froala-editor/css/froala_editor.pkgd.min.css';\r\nimport '../../assets/style/froala-theme.css';\r\n\r\n// Require Font Awesome.\r\nimport 'font-awesome/css/font-awesome.css';\r\n\r\n// Require block types\r\nimport { BLOCK_TABLE, BLOCK_IMAGE, BLOCK_TEXT, BLOCK_NAME } from '../../shared/blockType';\r\nimport {asyncComponent} from \"react-async-component\";\r\nimport {Box} from \"@lib/ui/Box/Box\";\r\nimport {\r\n  FROALA_BTN_TITLE_BIND,\r\n  FROALA_BTN_TITLE_COPY,\r\n  FROALA_BTN_TITLE_UNBIND\r\n} from \"@lib/ui/RichTextEditor/RichTextEditor\";\r\n\r\n\r\nconst FroalaEditor = asyncComponent({\r\n  resolve: () => import('react-froala-wysiwyg'),\r\n  LoadingComponent: ()=>(<Box border={'1px solid #848484'} px={'12px'} py={'10px'}>Загрузка...</Box>),\r\n  serverMode: 'defer'\r\n});\r\n\r\nexport class FroalaReduxForm extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = this.initialState;\r\n    this.handleModelChange = this.handleModelChange.bind(this);\r\n  }\r\n\r\n  get initialState() {\r\n    try {\r\n      return { model: this.props.input.value };\r\n    } catch (error) {\r\n      console.error(error);\r\n      return { model: null };\r\n    }\r\n  }\r\n\r\n  componentWillMount() {\r\n    const contentType = this.props.contenttype;\r\n    let toolbarButtons = [];\r\n    switch (contentType) {\r\n      case BLOCK_IMAGE:\r\n        toolbarButtons = [\r\n          FROALA_BTN_TITLE_COPY,\r\n          FROALA_BTN_TITLE_BIND,\r\n          FROALA_BTN_TITLE_UNBIND,\r\n          '|',\r\n          'insertImage',\r\n          'bold',\r\n          'italic',\r\n          'underline',\r\n          'fontSize',\r\n          'color',\r\n          'lineHeight',\r\n          'clearFormatting',\r\n          'align',\r\n          'formatOL',\r\n          'formatUL',\r\n          'outdent',\r\n          'indent',\r\n          'insertLink',\r\n          'specialCharacters',\r\n          'help',\r\n        ];\r\n        break;\r\n      case BLOCK_TABLE:\r\n        toolbarButtons = [\r\n          FROALA_BTN_TITLE_COPY,\r\n          FROALA_BTN_TITLE_BIND,\r\n          FROALA_BTN_TITLE_UNBIND,\r\n          '|',\r\n          'insertTable',\r\n          'bold',\r\n          'italic',\r\n          'underline',\r\n          'fontSize',\r\n          'color',\r\n          'lineHeight',\r\n          'clearFormatting',\r\n          'align',\r\n          'formatOL',\r\n          'formatUL',\r\n          'outdent',\r\n          'indent',\r\n          'insertLink',\r\n          'specialCharacters',\r\n          'help',\r\n        ];\r\n        break;\r\n      case BLOCK_TEXT:\r\n        toolbarButtons = [\r\n          FROALA_BTN_TITLE_COPY,\r\n          FROALA_BTN_TITLE_BIND,\r\n          FROALA_BTN_TITLE_UNBIND,\r\n          '|',\r\n          'bold',\r\n          'italic',\r\n          'underline',\r\n          'fontSize',\r\n          'color',\r\n          'lineHeight',\r\n          'clearFormatting',\r\n          'align',\r\n          'formatOL',\r\n          'formatUL',\r\n          'outdent',\r\n          'indent',\r\n          'insertLink',\r\n          'specialCharacters',\r\n          'help',\r\n        ];\r\n        break;\r\n      case BLOCK_NAME:\r\n        toolbarButtons = [];\r\n        break;\r\n    }\r\n    let EditorConfig = {\r\n      placeholderText: 'Введите текст',\r\n      theme: 'froala',\r\n      charCounterCount: false,\r\n      toolbarButtons: toolbarButtons,\r\n      autofocus: true,\r\n      language: 'ru'\r\n    };\r\n    this.setState({\r\n      ...this.state,\r\n      EditorConfig: EditorConfig,\r\n    });\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps) {\r\n    if (\r\n      nextProps.meta.error !== this.props.meta.error ||\r\n      nextProps.meta.active !== this.props.meta.active ||\r\n      nextProps.meta.touched !== this.props.meta.touched ||\r\n      nextProps.input.value !== this.props.input.value ||\r\n      nextProps.label !== this.props.label\r\n    ) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  handleModelChange(event) {\r\n    try {\r\n      console.log('Froala ReduxForm handleModelChange', event);\r\n      const { input } = this.props;\r\n      input.onChange(event);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { input, config } = this.props;\r\n\r\n    return (\r\n      <div>\r\n        <DefineIcons\r\n          buttonClick={action => {\r\n            this.props.handleButtonClick(action);\r\n          }}\r\n        />\r\n        <FroalaEditor\r\n          onModelChange={this.handleModelChange}\r\n          model={input.value}\r\n          tag={'textarea'}\r\n          config={{ ...config, ...this.state.EditorConfig,\r\n            language: 'ru' }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]}