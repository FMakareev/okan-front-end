0a5fba31f674622c35d11cc5c2a15a0c
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.FormProfileCreateUser = void 0;

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _reduxForm = require("redux-form");

var _reactApollo = require("react-apollo");

var _reactRedux = require("react-redux");

var _reactNotificationSystemRedux = require("react-notification-system-redux");

var _withSentry = require("../../../../hocs/withSentry/withSentry");

var _TextFieldWithTooltip = _interopRequireDefault(require("@lib/ui/TextFieldWithTooltip/TextFieldWithTooltip"));

var _ButtonWithImage = _interopRequireDefault(require("@lib/ui/ButtonWithImage/ButtonWithImage"));

var _SvgPlay = require("@lib/ui/Icons/SvgPlay");

var _Text = _interopRequireDefault(require("@lib/ui/Text/Text"));

var _PictureUploadPreview = _interopRequireDefault(require("@lib/ui/PictureUploadPreview/PictureUploadPreview"));

var _DayPickerField = _interopRequireDefault(require("@lib/ui/DayPickerField/DayPickerField"));

var _MaskedInputField = _interopRequireDefault(require("@lib/ui/MaskedInputField/MaskedInputField"));

var _FormPropTypes = require("../../../../propTypes/Forms/FormPropTypes");

var _required = _interopRequireDefault(require("../../../../utils/validation/required"));

var _isEmail = _interopRequireDefault(require("../../../../utils/validation/isEmail"));

var _CreateUserMutation = _interopRequireDefault(require("./CreateUserMutation.graphql"));

var _TextFieldFirstWrapper = require("@lib/ui/TextFieldFirstWrapper/TextFieldFirstWrapper");

var _TextFieldLastWrapper = require("@lib/ui/TextFieldLastWrapper/TextFieldLastWrapper");

/** View */

/**PropTypes */

/** Validation */

/** GraphQL schema */
var notificationOpts = function notificationOpts() {
  return {
    success: {
      title: 'Пользователь создан',
      message: 'Пользователь создан',
      position: 'tr',
      autoDismiss: 2
    },
    error: {
      title: 'Пользователь не создан',
      message: 'Пользователь не создан',
      position: 'tr',
      autoDismiss: 2
    }
  };
};

var FormProfileCreateUser =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(FormProfileCreateUser, _Component);

  function FormProfileCreateUser(props) {
    var _this;

    (0, _classCallCheck2["default"])(this, FormProfileCreateUser);
    _this = (0, _possibleConstructorReturn2["default"])(this, (0, _getPrototypeOf2["default"])(FormProfileCreateUser).call(this, props));
    _this.state = {};
    _this.submit = _this.submit.bind((0, _assertThisInitialized2["default"])(_this));
    return _this;
  }

  (0, _createClass2["default"])(FormProfileCreateUser, [{
    key: "submit",
    value: function submit(value) {
      var _this2 = this;

      var data = {
        variables: Object.assign({}, value)
      };
      return this.props['@apollo/create'](data).then(function (response) {
        _this2.props.setNotificationSuccess(notificationOpts().success);

        _this2.props.reset();

        return response;
      })["catch"](function (error) {
        var message = error.message;

        _this2.props.setNotificationError(notificationOpts().error);

        (0, _withSentry.captureException)(error);
        throw new _reduxForm.SubmissionError({
          _error: message
        });
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props = this.props,
          handleSubmit = _this$props.handleSubmit,
          pristine = _this$props.pristine,
          submitting = _this$props.submitting,
          invalid = _this$props.invalid;
      return _react["default"].createElement(_reduxForm.Form, {
        onSubmit: handleSubmit(this.submit)
      }, _react["default"].createElement(_Text["default"], {
        variant: 'documentTitle',
        mb: 13
      }, "\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F"), _react["default"].createElement(_TextFieldFirstWrapper.TextFieldFirstWrapper, null, _react["default"].createElement(_reduxForm.Field, {
        name: "firstname",
        component: _TextFieldWithTooltip["default"],
        placeholder: 'Фамилия',
        type: "text",
        size: 'md',
        fontFamily: 'secondary',
        validate: _required["default"]
      })), _react["default"].createElement(_reduxForm.Field, {
        name: "lastname",
        component: _TextFieldWithTooltip["default"],
        placeholder: 'Имя',
        type: "text",
        size: 'md',
        variant: 'primary',
        validate: _required["default"],
        fontFamily: 'secondary'
      }), _react["default"].createElement(_reduxForm.Field, {
        name: "patronymic",
        component: _TextFieldWithTooltip["default"],
        placeholder: 'Отчество',
        type: "text",
        size: 'md',
        variant: 'primary',
        validate: _required["default"],
        fontFamily: 'secondary'
      }), _react["default"].createElement(_reduxForm.Field, {
        name: "birthdate",
        component: _DayPickerField["default"],
        placeholder: 'Дата рождения',
        type: "text",
        variant: 'primary',
        validate: _required["default"],
        fontFamily: 'secondary'
      }), _react["default"].createElement(_reduxForm.Field, {
        name: "position",
        component: _TextFieldWithTooltip["default"],
        placeholder: 'Должность',
        type: "text",
        size: 'md',
        variant: 'primary',
        validate: _required["default"],
        fontFamily: 'secondary'
      }), _react["default"].createElement(_reduxForm.Field, {
        name: "phone",
        component: _MaskedInputField["default"],
        placeholder: '( 111 ) - 111 - 11 - 11',
        type: "text",
        validate: _required["default"],
        fontFamily: 'secondary'
      }), _react["default"].createElement(_reduxForm.Field, {
        name: "email",
        component: _TextFieldWithTooltip["default"],
        placeholder: 'Электронная почта',
        type: "text",
        size: 'md',
        variant: 'primary',
        validate: [_required["default"], _isEmail["default"]]
      }), _react["default"].createElement(_TextFieldLastWrapper.TextFieldLastWrapper, {
        mb: 11
      }, _react["default"].createElement(_reduxForm.Field, {
        name: "signature",
        component: _PictureUploadPreview["default"],
        placeholder: 'Загрузить подпись',
        type: "text",
        validate: _required["default"]
      })), _react["default"].createElement(_ButtonWithImage["default"], {
        type: "submit",
        variant: 'large',
        size: 'medium',
        children: 'Создать пользователя',
        rightIcon: (0, _SvgPlay.SvgPlay)(),
        ml: 9,
        disabled: pristine || submitting || invalid,
        width: '100%',
        widthIcon: '10px'
      }));
    }
  }]);
  return FormProfileCreateUser;
}(_react.Component);

exports.FormProfileCreateUser = FormProfileCreateUser;
(0, _defineProperty2["default"])(FormProfileCreateUser, "propTypes", (0, _objectSpread2["default"])({}, _FormPropTypes.formPropTypes));
exports.FormProfileCreateUser = FormProfileCreateUser = (0, _reactApollo.graphql)(_CreateUserMutation["default"], {
  name: '@apollo/create'
})(FormProfileCreateUser);
exports.FormProfileCreateUser = FormProfileCreateUser = (0, _reactRedux.connect)(function (state) {
  return {
    values: (0, _reduxForm.getFormValues)('FormProfileCreateUser')(state)
  };
}, function (dispatch) {
  return {
    // addUser: user => dispatch({ type: USER_ADD, user }), // TODO review: не забываем импортировать, и addUser тут не нужно
    setNotificationSuccess: function setNotificationSuccess(message) {
      return dispatch((0, _reactNotificationSystemRedux.success)(message));
    },
    setNotificationError: function setNotificationError(message) {
      return dispatch((0, _reactNotificationSystemRedux.error)(message));
    }
  };
})(FormProfileCreateUser);
exports.FormProfileCreateUser = FormProfileCreateUser = (0, _reduxForm.reduxForm)({
  form: 'FormProfileCreateUser'
})(FormProfileCreateUser);
var _default = FormProfileCreateUser;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZvcm1Qcm9maWxlQ3JlYXRlVXNlci5qcyJdLCJuYW1lcyI6WyJub3RpZmljYXRpb25PcHRzIiwic3VjY2VzcyIsInRpdGxlIiwibWVzc2FnZSIsInBvc2l0aW9uIiwiYXV0b0Rpc21pc3MiLCJlcnJvciIsIkZvcm1Qcm9maWxlQ3JlYXRlVXNlciIsInByb3BzIiwic3RhdGUiLCJzdWJtaXQiLCJiaW5kIiwidmFsdWUiLCJkYXRhIiwidmFyaWFibGVzIiwiT2JqZWN0IiwiYXNzaWduIiwidGhlbiIsInJlc3BvbnNlIiwic2V0Tm90aWZpY2F0aW9uU3VjY2VzcyIsInJlc2V0Iiwic2V0Tm90aWZpY2F0aW9uRXJyb3IiLCJTdWJtaXNzaW9uRXJyb3IiLCJfZXJyb3IiLCJoYW5kbGVTdWJtaXQiLCJwcmlzdGluZSIsInN1Ym1pdHRpbmciLCJpbnZhbGlkIiwiVGV4dEZpZWxkV2l0aFRvb2x0aXAiLCJyZXF1aXJlZCIsIkRheVBpY2tlckZpZWxkIiwiTWFza2VkSW5wdXRGaWVsZCIsImlzRW1haWwiLCJQaWN0dXJlVXBsb2FkUHJldmlldyIsIkNvbXBvbmVudCIsImZvcm1Qcm9wVHlwZXMiLCJDcmVhdGVVc2VyTXV0YXRpb24iLCJuYW1lIiwidmFsdWVzIiwiZGlzcGF0Y2giLCJmb3JtIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQTs7QUFHQTs7QUFDQTs7QUFHQTs7QUFDQTs7QUFDQTs7QUFuQkE7O0FBU0E7O0FBR0E7O0FBSUE7QUFLQSxJQUFNQSxnQkFBZ0IsR0FBRyxTQUFuQkEsZ0JBQW1CO0FBQUEsU0FBTztBQUM5QkMsSUFBQUEsT0FBTyxFQUFFO0FBQ1BDLE1BQUFBLEtBQUssRUFBRSxxQkFEQTtBQUVQQyxNQUFBQSxPQUFPLEVBQUUscUJBRkY7QUFHUEMsTUFBQUEsUUFBUSxF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QixJQUFBQSxvQkFBb0IsRUFBRSw4QkFBQWxCLE9BQU87QUFBQSxhQUFJb0MsUUFBUSxDQUFDLHlDQUFNcEMsT0FBTixDQUFELENBQVo7QUFBQTtBQUhsQixHQUFMO0FBQUEsQ0FKYyxFQVN0QkkscUJBVHNCLENBQXhCO0FBV0EsZ0NBQUFBLHFCQUFxQixHQUFHLDBCQUFVO0FBQ2hDaUMsRUFBQUEsSUFBSSxFQUFFO0FBRDBCLENBQVYsRUFFckJqQyxxQkFGcUIsQ0FBeEI7ZUFJZUEscUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBGaWVsZCwgcmVkdXhGb3JtLCBTdWJtaXNzaW9uRXJyb3IsIEZvcm0sIGdldEZvcm1WYWx1ZXMgfSBmcm9tICdyZWR1eC1mb3JtJztcclxuaW1wb3J0IHsgZ3JhcGhxbCB9IGZyb20gJ3JlYWN0LWFwb2xsbyc7XHJcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCc7XHJcbmltcG9ydCB7IHN1Y2Nlc3MsIGVycm9yIH0gZnJvbSAncmVhY3Qtbm90aWZpY2F0aW9uLXN5c3RlbS1yZWR1eCc7XHJcbmltcG9ydCB7IGNhcHR1cmVFeGNlcHRpb24gfSBmcm9tICcuLi8uLi8uLi8uLi9ob2NzL3dpdGhTZW50cnkvd2l0aFNlbnRyeSc7XHJcblxyXG4vKiogVmlldyAqL1xyXG5pbXBvcnQgVGV4dEZpZWxkV2l0aFRvb2x0aXAgZnJvbSAnQGxpYi91aS9UZXh0RmllbGRXaXRoVG9vbHRpcC9UZXh0RmllbGRXaXRoVG9vbHRpcCc7XHJcbmltcG9ydCBCdXR0b25XaXRoSW1hZ2UgZnJvbSAnQGxpYi91aS9CdXR0b25XaXRoSW1hZ2UvQnV0dG9uV2l0aEltYWdlJztcclxuaW1wb3J0IHsgU3ZnUGxheSB9IGZyb20gJ0BsaWIvdWkvSWNvbnMvU3ZnUGxheSc7XHJcbmltcG9ydCBUZXh0IGZyb20gJ0BsaWIvdWkvVGV4dC9UZXh0JztcclxuaW1wb3J0IFBpY3R1cmVVcGxvYWRQcmV2aWV3IGZyb20gJ0BsaWIvdWkvUGljdHVyZVVwbG9hZFByZXZpZXcvUGljdHVyZVVwbG9hZFByZXZpZXcnO1xyXG5pbXBvcnQgRGF5UGlja2VyRmllbGQgZnJvbSAnQGxpYi91aS9EYXlQaWNrZXJGaWVsZC9EYXlQaWNrZXJGaWVsZCc7XHJcbmltcG9ydCBNYXNrZWRJbnB1dEZpZWxkIGZyb20gJ0BsaWIvdWkvTWFza2VkSW5wdXRGaWVsZC9NYXNrZWRJbnB1dEZpZWxkJztcclxuXHJcbi8qKlByb3BUeXBlcyAqL1xyXG5pbXBvcnQgeyBmb3JtUHJvcFR5cGVzIH0gZnJvbSAnLi4vLi4vLi4vLi4vcHJvcFR5cGVzL0Zvcm1zL0Zvcm1Qcm9wVHlwZXMnO1xyXG5cclxuLyoqIFZhbGlkYXRpb24gKi9cclxuaW1wb3J0IHJlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3V0aWxzL3ZhbGlkYXRpb24vcmVxdWlyZWQnO1xyXG5pbXBvcnQgaXNFbWFpbCBmcm9tICcuLi8uLi8uLi8uLi91dGlscy92YWxpZGF0aW9uL2lzRW1haWwnO1xyXG5cclxuLyoqIEdyYXBoUUwgc2NoZW1hICovXHJcbmltcG9ydCBDcmVhdGVVc2VyTXV0YXRpb24gZnJvbSAnLi9DcmVhdGVVc2VyTXV0YXRpb24uZ3JhcGhxbCc7XHJcbmltcG9ydCB7IFRleHRGaWVsZEZpcnN0V3JhcHBlciB9IGZyb20gJ0BsaWIvdWkvVGV4dEZpZWxkRmlyc3RXcmFwcGVyL1RleHRGaWVsZEZpcnN0V3JhcHBlcic7XHJcbmltcG9ydCB7IFRleHRGaWVsZExhc3RXcmFwcGVyIH0gZnJvbSAnQGxpYi91aS9UZXh0RmllbGRMYXN0V3JhcHBlci9UZXh0RmllbGRMYXN0V3JhcHBlcic7XHJcblxyXG5jb25zdCBub3RpZmljYXRpb25PcHRzID0gKCkgPT4gKHtcclxuICBzdWNjZXNzOiB7XHJcbiAgICB0aXRsZTogJ9Cf0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCDRgdC+0LfQtNCw0L0nLFxyXG4gICAgbWVzc2FnZTogJ9Cf0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCDRgdC+0LfQtNCw0L0nLFxyXG4gICAgcG9zaXRpb246ICd0cicsXHJcbiAgICBhdXRvRGlzbWlzczogMixcclxuICB9LFxyXG4gIGVycm9yOiB7XHJcbiAgICB0aXRsZTogJ9Cf0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCDQvdC1INGB0L7Qt9C00LDQvScsXHJcbiAgICBtZXNzYWdlOiAn0J/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINC90LUg0YHQvtC30LTQsNC9JyxcclxuICAgIHBvc2l0aW9uOiAndHInLFxyXG4gICAgYXV0b0Rpc21pc3M6IDIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5leHBvcnQgY2xhc3MgRm9ybVByb2ZpbGVDcmVhdGVVc2VyIGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICBzdGF0aWMgcHJvcFR5cGVzID0geyAuLi5mb3JtUHJvcFR5cGVzIH07XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcblxyXG4gICAgdGhpcy5zdGF0ZSA9IHt9O1xyXG5cclxuICAgIHRoaXMuc3VibWl0ID0gdGhpcy5zdWJtaXQuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIHN1Ym1pdCh2YWx1ZSkge1xyXG4gICAgY29uc3QgZGF0YSA9IHsgdmFyaWFibGVzOiBPYmplY3QuYXNzaWduKHt9LCB2YWx1ZSkgfTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5wcm9wc1snQGFwb2xsby9jcmVhdGUnXShkYXRhKVxyXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB7XHJcbiAgICAgICAgdGhpcy5wcm9wcy5zZXROb3RpZmljYXRpb25TdWNjZXNzKG5vdGlmaWNhdGlvbk9wdHMoKS5zdWNjZXNzKTtcclxuICAgICAgICB0aGlzLnByb3BzLnJlc2V0KCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgbWVzc2FnZSB9ID0gZXJyb3I7XHJcbiAgICAgICAgdGhpcy5wcm9wcy5zZXROb3RpZmljYXRpb25FcnJvcihub3RpZmljYXRpb25PcHRzKCkuZXJyb3IpO1xyXG4gICAgICAgIGNhcHR1cmVFeGNlcHRpb24oZXJyb3IpO1xyXG5cclxuICAgICAgICB0aHJvdyBuZXcgU3VibWlzc2lvbkVycm9yKHsgX2Vycm9yOiBtZXNzYWdlIH0pO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgaGFuZGxlU3VibWl0LCBwcmlzdGluZSwgc3VibWl0dGluZywgaW52YWxpZCB9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8Rm9ybSBvblN1Ym1pdD17aGFuZGxlU3VibWl0KHRoaXMuc3VibWl0KX0+XHJcbiAgICAgICAgPFRleHQgdmFyaWFudD17J2RvY3VtZW50VGl0bGUnfSBtYj17MTN9PlxyXG4gICAgICAgICAg0KHQvtC30LTQsNGC0Ywg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXHJcbiAgICAgICAgPC9UZXh0PlxyXG5cclxuICAgICAgICA8VGV4dEZpZWxkRmlyc3RXcmFwcGVyPlxyXG4gICAgICAgICAgPEZpZWxkXHJcbiAgICAgICAgICAgIG5hbWU9XCJmaXJzdG5hbWVcIlxyXG4gICAgICAgICAgICBjb21wb25lbnQ9e1RleHRGaWVsZFdpdGhUb29sdGlwfVxyXG4gICAgICAgICAgICBwbGFjZWhvbGRlcj17J9Ck0LDQvNC40LvQuNGPJ31cclxuICAgICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgICBzaXplPXsnbWQnfVxyXG4gICAgICAgICAgICBmb250RmFtaWx5PXsnc2Vjb25kYXJ5J31cclxuICAgICAgICAgICAgdmFsaWRhdGU9e3JlcXVpcmVkfVxyXG4gICAgICAgICAgLz5cclxuICAgICAgICA8L1RleHRGaWVsZEZpcnN0V3JhcHBlcj5cclxuXHJcbiAgICAgICAgPEZpZWxkXHJcbiAgICAgICAgICBuYW1lPVwibGFzdG5hbWVcIlxyXG4gICAgICAgICAgY29tcG9uZW50PXtUZXh0RmllbGRXaXRoVG9vbHRpcH1cclxuICAgICAgICAgIHBsYWNlaG9sZGVyPXsn0JjQvNGPJ31cclxuICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgIHNpemU9eydtZCd9XHJcbiAgICAgICAgICB2YXJpYW50PXsncHJpbWFyeSd9XHJcbiAgICAgICAgICB2YWxpZGF0ZT17cmVxdWlyZWR9XHJcbiAgICAgICAgICBmb250RmFtaWx5PXsnc2Vjb25kYXJ5J31cclxuICAgICAgICAvPlxyXG5cclxuICAgICAgICA8RmllbGRcclxuICAgICAgICAgIG5hbWU9XCJwYXRyb255bWljXCJcclxuICAgICAgICAgIGNvbXBvbmVudD17VGV4dEZpZWxkV2l0aFRvb2x0aXB9XHJcbiAgICAgICAgICBwbGFjZWhvbGRlcj17J9Ce0YLRh9C10YHRgtCy0L4nfVxyXG4gICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgc2l6ZT17J21kJ31cclxuICAgICAgICAgIHZhcmlhbnQ9eydwcmltYXJ5J31cclxuICAgICAgICAgIHZhbGlkYXRlPXtyZXF1aXJlZH1cclxuICAgICAgICAgIGZvbnRGYW1pbHk9eydzZWNvbmRhcnknfVxyXG4gICAgICAgIC8+XHJcblxyXG4gICAgICAgIDxGaWVsZFxyXG4gICAgICAgICAgbmFtZT1cImJpcnRoZGF0ZVwiXHJcbiAgICAgICAgICBjb21wb25lbnQ9e0RheVBpY2tlckZpZWxkfVxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9eyfQlNCw0YLQsCDRgNC+0LbQtNC10L3QuNGPJ31cclxuICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgIHZhcmlhbnQ9eydwcmltYXJ5J31cclxuICAgICAgICAgIHZhbGlkYXRlPXtyZXF1aXJlZH1cclxuICAgICAgICAgIGZvbnRGYW1pbHk9eydzZWNvbmRhcnknfVxyXG4gICAgICAgIC8+XHJcblxyXG4gICAgICAgIDxGaWVsZFxyXG4gICAgICAgICAgbmFtZT1cInBvc2l0aW9uXCJcclxuICAgICAgICAgIGNvbXBvbmVudD17VGV4dEZpZWxkV2l0aFRvb2x0aXB9XHJcbiAgICAgICAgICBwbGFjZWhvbGRlcj17J9CU0L7Qu9C20L3QvtGB0YLRjCd9XHJcbiAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICBzaXplPXsnbWQnfVxyXG4gICAgICAgICAgdmFyaWFudD17J3ByaW1hcnknfVxyXG4gICAgICAgICAgdmFsaWRhdGU9e3JlcXVpcmVkfVxyXG4gICAgICAgICAgZm9udEZhbWlseT17J3NlY29uZGFyeSd9XHJcbiAgICAgICAgLz5cclxuXHJcbiAgICAgICAgPEZpZWxkXHJcbiAgICAgICAgICBuYW1lPVwicGhvbmVcIlxyXG4gICAgICAgICAgY29tcG9uZW50PXtNYXNrZWRJbnB1dEZpZWxkfVxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9eycoIDExMSApIC0gMTExIC0gMTEgLSAxMSd9XHJcbiAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICB2YWxpZGF0ZT17cmVxdWlyZWR9XHJcbiAgICAgICAgICBmb250RmFtaWx5PXsnc2Vjb25kYXJ5J31cclxuICAgICAgICAvPlxyXG5cclxuICAgICAgICA8RmllbGRcclxuICAgICAgICAgIG5hbWU9XCJlbWFpbFwiXHJcbiAgICAgICAgICBjb21wb25lbnQ9e1RleHRGaWVsZFdpdGhUb29sdGlwfVxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9eyfQrdC70LXQutGC0YDQvtC90L3QsNGPINC/0L7Rh9GC0LAnfVxyXG4gICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgc2l6ZT17J21kJ31cclxuICAgICAgICAgIHZhcmlhbnQ9eydwcmltYXJ5J31cclxuICAgICAgICAgIHZhbGlkYXRlPXtbcmVxdWlyZWQsIGlzRW1haWxdfVxyXG4gICAgICAgIC8+XHJcblxyXG4gICAgICAgIDxUZXh0RmllbGRMYXN0V3JhcHBlciBtYj17MTF9PlxyXG4gICAgICAgICAgPEZpZWxkXHJcbiAgICAgICAgICAgIG5hbWU9XCJzaWduYXR1cmVcIlxyXG4gICAgICAgICAgICBjb21wb25lbnQ9e1BpY3R1cmVVcGxvYWRQcmV2aWV3fVxyXG4gICAgICAgICAgICBwbGFjZWhvbGRlcj17J9CX0LDQs9GA0YPQt9C40YLRjCDQv9C+0LTQv9C40YHRjCd9XHJcbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgICAgdmFsaWRhdGU9e3JlcXVpcmVkfVxyXG4gICAgICAgICAgLz5cclxuICAgICAgICA8L1RleHRGaWVsZExhc3RXcmFwcGVyPlxyXG5cclxuICAgICAgICA8QnV0dG9uV2l0aEltYWdlXHJcbiAgICAgICAgICB0eXBlPVwic3VibWl0XCJcclxuICAgICAgICAgIHZhcmlhbnQ9eydsYXJnZSd9XHJcbiAgICAgICAgICBzaXplPXsnbWVkaXVtJ31cclxuICAgICAgICAgIGNoaWxkcmVuPXsn0KHQvtC30LTQsNGC0Ywg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPJ31cclxuICAgICAgICAgIHJpZ2h0SWNvbj17U3ZnUGxheSgpfVxyXG4gICAgICAgICAgbWw9ezl9XHJcbiAgICAgICAgICBkaXNhYmxlZD17cHJpc3RpbmUgfHwgc3VibWl0dGluZyB8fCBpbnZhbGlkfVxyXG4gICAgICAgICAgd2lkdGg9eycxMDAlJ31cclxuICAgICAgICAgIHdpZHRoSWNvbj17JzEwcHgnfVxyXG4gICAgICAgIC8+XHJcbiAgICAgIDwvRm9ybT5cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5Gb3JtUHJvZmlsZUNyZWF0ZVVzZXIgPSBncmFwaHFsKENyZWF0ZVVzZXJNdXRhdGlvbiwge1xyXG4gIG5hbWU6ICdAYXBvbGxvL2NyZWF0ZScsXHJcbn0pKEZvcm1Qcm9maWxlQ3JlYXRlVXNlcik7XHJcblxyXG5Gb3JtUHJvZmlsZUNyZWF0ZVVzZXIgPSBjb25uZWN0KFxyXG4gIHN0YXRlID0+ICh7XHJcbiAgICB2YWx1ZXM6IGdldEZvcm1WYWx1ZXMoJ0Zvcm1Qcm9maWxlQ3JlYXRlVXNlcicpKHN0YXRlKSxcclxuICB9KSxcclxuICBkaXNwYXRjaCA9PiAoe1xyXG4gICAgLy8gYWRkVXNlcjogdXNlciA9PiBkaXNwYXRjaCh7IHR5cGU6IFVTRVJfQURELCB1c2VyIH0pLCAvLyBUT0RPIHJldmlldzog0L3QtSDQt9Cw0LHRi9Cy0LDQtdC8INC40LzQv9C+0YDRgtC40YDQvtCy0LDRgtGMLCDQuCBhZGRVc2VyINGC0YPRgiDQvdC1INC90YPQttC90L5cclxuICAgIHNldE5vdGlmaWNhdGlvblN1Y2Nlc3M6IG1lc3NhZ2UgPT4gZGlzcGF0Y2goc3VjY2VzcyhtZXNzYWdlKSksXHJcbiAgICBzZXROb3RpZmljYXRpb25FcnJvcjogbWVzc2FnZSA9PiBkaXNwYXRjaChlcnJvcihtZXNzYWdlKSksXHJcbiAgfSksXHJcbikoRm9ybVByb2ZpbGVDcmVhdGVVc2VyKTtcclxuXHJcbkZvcm1Qcm9maWxlQ3JlYXRlVXNlciA9IHJlZHV4Rm9ybSh7XHJcbiAgZm9ybTogJ0Zvcm1Qcm9maWxlQ3JlYXRlVXNlcicsXHJcbn0pKEZvcm1Qcm9maWxlQ3JlYXRlVXNlcik7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtUHJvZmlsZUNyZWF0ZVVzZXI7XHJcbiJdfQ==