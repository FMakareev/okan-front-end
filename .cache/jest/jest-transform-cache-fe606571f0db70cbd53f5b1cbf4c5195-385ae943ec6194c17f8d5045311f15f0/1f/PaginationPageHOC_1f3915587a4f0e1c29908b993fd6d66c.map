{"version":3,"sources":["PaginationPageHOC.js"],"names":["PaginationPageHOC","props","fetchMore","state","pageSize","pageNumber","queryName","query","queryVariables","variables","updateQuery","previousResult","fetchMoreResult","setState","reFetchAfterSetState","error","console","log","initialState","loading","data","Children","children","nextPage","disabledToNextPage","length","prevPage","disabledToPrevPage","Component","PropTypes","string","number","any"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n/**View */\r\nimport { Query } from 'react-apollo';\r\n\r\nexport class PaginationPageHOC extends Component {\r\n  static propTypes = {\r\n    queryName: PropTypes.string,\r\n    pageSize: PropTypes.number,\r\n    pageNumber: PropTypes.number,\r\n    query: PropTypes.any,\r\n    queryVariables: PropTypes.any,\r\n  };\r\n\r\n  static defaultProps = {\r\n    pageSize: 10,\r\n    pageNumber: 1,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = this.initialState;\r\n  }\r\n\r\n  get initialState() {\r\n    const { pageNumber, pageSize } = this.props;\r\n    return {\r\n      pageNumber,\r\n      pageSize,\r\n    };\r\n  }\r\n\r\n  reFetchAfterSetState = fetchMore => () => {\r\n    const { pageSize, pageNumber } = this.state;\r\n    const { queryName, query, queryVariables } = this.props;\r\n    fetchMore({\r\n      query: query,\r\n      variables: {\r\n        ...queryVariables,\r\n        pageSize: pageSize,\r\n        pageNumber: pageNumber,\r\n      },\r\n      updateQuery: (previousResult, { fetchMoreResult }) => {\r\n        if (!fetchMoreResult) return { [queryName]: [] };\r\n        return fetchMoreResult;\r\n      },\r\n    });\r\n  };\r\n\r\n  prevPage = fetchMore => {\r\n    const { pageNumber } = this.state;\r\n    try {\r\n      if (pageNumber >= 1) {\r\n        this.setState(\r\n          state => ({\r\n            ...state,\r\n            pageNumber: pageNumber - 1,\r\n          }),\r\n          this.reFetchAfterSetState(fetchMore),\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  nextPage = fetchMore => {\r\n    const { pageNumber } = this.state;\r\n    try {\r\n      this.setState(\r\n        state => ({\r\n          ...state,\r\n          pageNumber: pageNumber + 1,\r\n        }),\r\n        this.reFetchAfterSetState(fetchMore),\r\n      );\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { query, queryVariables, queryName } = this.props;\r\n    const { pageNumber, pageSize } = this.state;\r\n\r\n    return (\r\n      <Query\r\n        skip={!query}\r\n        variables={{\r\n          ...queryVariables,\r\n          pageSize: pageSize,\r\n          pageNumber: pageNumber,\r\n        }}\r\n        query={query}>\r\n        {({ loading, error, data, fetchMore }) => {\r\n          const Children = this.props.children;\r\n          return (\r\n            <Children\r\n              data={data}\r\n              loading={loading}\r\n              error={error}\r\n              pagination={{\r\n                pageSize: pageSize,\r\n                pageNumber: pageNumber,\r\n                nextPage: () => {\r\n                  this.nextPage(fetchMore, data);\r\n                },\r\n                disabledToNextPage:\r\n                  loading ||\r\n                  (data[queryName] && data[queryName].length === 0) ||\r\n                  (data[queryName] && data[queryName].length < pageSize),\r\n                prevPage: () => {\r\n                  this.prevPage(fetchMore, data);\r\n                },\r\n                disabledToPrevPage: pageNumber - 1 < 1,\r\n              }}\r\n            />\r\n          );\r\n        }}\r\n      </Query>\r\n    );\r\n  }\r\n}\r\n\r\nexport default PaginationPageHOC;\r\n"]}