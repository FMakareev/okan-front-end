dbd8469960635b0352f669d0e5c918b7
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.FormProjectSettings = void 0;

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _reactRedux = require("react-redux");

var _reactApollo = require("react-apollo");

var _reactNotificationSystemRedux = require("react-notification-system-redux");

var _reduxForm = require("redux-form");

var _UserListQuery = _interopRequireDefault(require("./UserListQuery.graphql"));

var _reactRouterDom = require("react-router-dom");

var _TextFieldWithTooltip = _interopRequireDefault(require("@lib/ui/TextFieldWithTooltip/TextFieldWithTooltip"));

var _ButtonWithImage = _interopRequireDefault(require("@lib/ui/ButtonWithImage/ButtonWithImage"));

var _Text = _interopRequireDefault(require("@lib/ui/Text/Text"));

var _Box = _interopRequireDefault(require("@lib/ui/Box/Box"));

var _TextFieldArray = _interopRequireDefault(require("@lib/ui/TextFieldArray/TextFieldArray"));

var _CheckboxBase = require("@lib/ui/CheckboxBase/CheckboxBase");

var _SvgSave = require("@lib/ui/Icons/SvgSave");

var _FormPropTypes = require("../../../../propTypes/Forms/FormPropTypes");

var _ProjectSettingsMutation = _interopRequireDefault(require("./ProjectSettingsMutation.graphql"));

var _withSentry = require("../../../../hocs/withSentry/withSentry");

var _FormProjectCreate = require("../FormProjectCreate/FormProjectCreate");

/**View */

/**Image */

/**PropTypes */

/** Graphql schema */

/** CSS style in other Component */
var notificationOpts = function notificationOpts() {
  return {
    success: {
      title: 'Настройки проекта успешно обновлены',
      message: 'Настройки проекта успешно обновлены',
      position: 'tr',
      autoDismiss: 2
    },
    error: {
      title: 'Настройки проекта не обновлены',
      message: 'Настройки проекта не обновлены',
      position: 'tr',
      autoDismiss: 2
    }
  };
};

var FormProjectSettings =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(FormProjectSettings, _Component);

  function FormProjectSettings() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2["default"])(this, FormProjectSettings);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2["default"])(this, (_getPrototypeOf2 = (0, _getPrototypeOf3["default"])(FormProjectSettings)).call.apply(_getPrototypeOf2, [this].concat(args)));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "state", _this.initialState);
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "submit", function (value) {
      var data = {
        variables: Object.assign({}, value)
      };
      return _this.props['@apollo/update'](data).then(function (response) {
        _this.props.setNotificationSuccess(notificationOpts().success);

        _this.setState(function () {
          return {
            redirect: '/app/project-list'
          };
        });

        return response;
      })["catch"](function (_ref) {
        var graphQLErrors = _ref.graphQLErrors,
            message = _ref.message;

        _this.props.setNotificationError(notificationOpts().error);

        (0, _withSentry.captureException)(_reactNotificationSystemRedux.error);
        throw new _reduxForm.SubmissionError({
          _error: message
        });
      });
    });
    return _this;
  }

  (0, _createClass2["default"])(FormProjectSettings, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          handleSubmit = _this$props.handleSubmit,
          submitting = _this$props.submitting,
          invalid = _this$props.invalid;
      var redirect = this.state.redirect;

      if (redirect) {
        return _react["default"].createElement(_reactRouterDom.Redirect, {
          to: redirect
        });
      }

      return _react["default"].createElement(_reduxForm.Form, {
        onSubmit: handleSubmit(this.submit)
      }, _react["default"].createElement(_FormProjectCreate.BoxStyled, {
        mb: 16
      }, _react["default"].createElement(_reduxForm.Field, {
        name: "name",
        component: _TextFieldWithTooltip["default"],
        placeholder: 'Название документа',
        type: "text",
        fontSize: 6,
        lineHeight: 8,
        fontFamily: 'secondary'
      })), _react["default"].createElement(_Text["default"], {
        variant: 'documentTitle',
        mb: 4
      }, "\u0421\u043E\u0433\u043B\u0430\u0441\u0443\u044E\u0449\u0438\u0435"), _react["default"].createElement(_Box["default"], {
        mb: '45px'
      }, _react["default"].createElement(_reactApollo.Query, {
        query: _UserListQuery["default"]
      }, function (_ref2) {
        var loading = _ref2.loading,
            data = _ref2.data;
        return _react["default"].createElement(_reduxForm.Field, {
          isLoading: loading,
          name: 'partners',
          component: _TextFieldArray["default"],
          type: 'text',
          labelKey: 'name',
          valueKey: 'id',
          options: data && data.userlist && data.userlist.map(function (item) {
            return {
              id: item.id,
              name: "".concat(item.firstname, " ").concat(item.lastname, " ").concat(item.patronymic)
            };
          })
        });
      })), _react["default"].createElement(_Box["default"], {
        mb: '90px'
      }, _react["default"].createElement(_reduxForm.Field, {
        component: _CheckboxBase.CheckboxBase,
        name: 'isTemplate'
      }, _react["default"].createElement(_Text["default"], {
        fontFamily: 'primary300',
        fontSize: 6,
        lineHeight: 8,
        color: 'color11',
        ml: 20
      }, "\u0421\u0434\u0435\u043B\u0430\u0442\u044C \u043F\u0440\u043E\u0435\u043A\u0442 \u0448\u0430\u0431\u043B\u043E\u043D\u043E\u043C"))), _react["default"].createElement(_ButtonWithImage["default"], {
        type: "submit",
        variant: 'large',
        size: 'medium',
        children: 'Сохранить настройки',
        leftIcon: (0, _SvgSave.SvgSave)(),
        mr: 9,
        disabled: submitting || invalid,
        width: '100%',
        widthIcon: '16px'
      }));
    }
  }, {
    key: "initialState",
    get: function get() {
      return {
        redirect: null
      };
    }
  }]);
  return FormProjectSettings;
}(_react.Component);

exports.FormProjectSettings = FormProjectSettings;
(0, _defineProperty2["default"])(FormProjectSettings, "propTypes", (0, _objectSpread2["default"])({
  handleSubmit: _propTypes["default"].func,
  invalid: _propTypes["default"].bool,
  mb: _propTypes["default"].string,
  setNotificationError: _propTypes["default"].func,
  setNotificationSuccess: _propTypes["default"].func,
  submitting: _propTypes["default"].bool
}, _FormPropTypes.formPropTypes));
exports.FormProjectSettings = FormProjectSettings = (0, _reactApollo.graphql)(_ProjectSettingsMutation["default"], {
  name: '@apollo/update'
})(FormProjectSettings);
exports.FormProjectSettings = FormProjectSettings = (0, _reactRedux.connect)(function (state) {
  return {
    values: (0, _reduxForm.getFormValues)('FormProjectSettings')(state)
  };
}, function (dispatch) {
  return {
    setNotificationSuccess: function setNotificationSuccess(message) {
      return dispatch((0, _reactNotificationSystemRedux.success)(message));
    },
    setNotificationError: function setNotificationError(message) {
      return dispatch((0, _reactNotificationSystemRedux.error)(message));
    }
  };
})(FormProjectSettings);
exports.FormProjectSettings = FormProjectSettings = (0, _reduxForm.reduxForm)({
  form: 'FormProjectSettings'
})(FormProjectSettings);
var _default = FormProjectSettings;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZvcm1Qcm9qZWN0U2V0dGluZ3MuanMiXSwibmFtZXMiOlsibm90aWZpY2F0aW9uT3B0cyIsInN1Y2Nlc3MiLCJ0aXRsZSIsIm1lc3NhZ2UiLCJwb3NpdGlvbiIsImF1dG9EaXNtaXNzIiwiZXJyb3IiLCJGb3JtUHJvamVjdFNldHRpbmdzIiwiaW5pdGlhbFN0YXRlIiwidmFsdWUiLCJkYXRhIiwidmFyaWFibGVzIiwiT2JqZWN0IiwiYXNzaWduIiwicHJvcHMiLCJ0aGVuIiwicmVzcG9uc2UiLCJzZXROb3RpZmljYXRpb25TdWNjZXNzIiwic2V0U3RhdGUiLCJyZWRpcmVjdCIsImdyYXBoUUxFcnJvcnMiLCJzZXROb3RpZmljYXRpb25FcnJvciIsIlN1Ym1pc3Npb25FcnJvciIsIl9lcnJvciIsImhhbmRsZVN1Ym1pdCIsInN1Ym1pdHRpbmciLCJpbnZhbGlkIiwic3RhdGUiLCJzdWJtaXQiLCJUZXh0RmllbGRXaXRoVG9vbHRpcCIsIlVzZXJMaXN0UXVlcnkiLCJsb2FkaW5nIiwiVGV4dEZpZWxkQXJyYXkiLCJ1c2VybGlzdCIsIm1hcCIsIml0ZW0iLCJpZCIsIm5hbWUiLCJmaXJzdG5hbWUiLCJsYXN0bmFtZSIsInBhdHJvbnltaWMiLCJDaGVja2JveEJhc2UiLCJDb21wb25lbnQiLCJQcm9wVHlwZXMiLCJmdW5jIiwiYm9vbCIsIm1iIiwic3RyaW5nIiwiZm9ybVByb3BUeXBlcyIsIlByb2plY3RTZXR0aW5nc011dGF0aW9uIiwidmFsdWVzIiwiZGlzcGF0Y2giLCJmb3JtIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQTs7QUFHQTs7QUFHQTs7QUFDQTs7QUFHQTs7QUFuQkE7O0FBUUE7O0FBR0E7O0FBR0E7O0FBSUE7QUFHQSxJQUFNQSxnQkFBZ0IsR0FBRyxTQUFuQkEsZ0JBQW1CO0FBQUEsU0FBTztBQUM5QkMsSUFBQUEsT0FBTyxFQUFFO0FBQ1BDLE1BQUFBLEtBQUssRUFBRSxxQ0FEQTtBQUVQQyxNQUFBQSxPQUFPLEVBQUUscUNBRkY7QUFHUEMsTUFBQUEsUUFBUSxFQUFFLElBSEg7QUFJUEMsTUFBQUEsV0FBVyxFQUFFO0FBSk4sS0FEcUI7QUFPOUJDLElBQUFBLEtBQUssRUFBRTtBQUNMSixNQUFBQSxLQUFLLEVBQUUsZ0NBREY7QUFFTEMsTUFBQUEsT0FBTyxFQUFFLGdDQUZKO0FBR0xDLE1BQUFBLFFBQVEsRUFBRSxJQUhMO0FBSUxDLE1BQUFBLFdBQVcsRUFBRTtBQUpSO0FBUHVCLEdBQVA7QUFBQSxDQUF6Qjs7SUFlYUUsbUI7Ozs7Ozs7Ozs7Ozs7Ozs7OzhGQVdILE1BQUtDLFk7K0ZBTUosVUFBQUMsS0FBSyxFQUFJO0FBQ2hCLFVBQU1DLElBQUksR0FBRztBQUFFQyxRQUFBQSxTQUFTLEVBQUVDLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLEVBQWQsRUFBa0JKLEtBQWxCO0FBQWIsT0FBYjtBQUVBLGFBQU8sTUFBS0ssS0FBTCxDQUFXLGdCQUFYLEVBQTZCSixJQUE3QixFQUNKSyxJQURJLENBQ0MsVUFBQUMsUUFBUSxFQUFJO0FBQ2hCLGNBQUtGLEtBQUwsQ0FBV0csc0JBQVgsQ0FBa0NqQixnQkFBZ0IsR0FBR0MsT0FBckQ7O0FBQ0EsY0FBS2lCLFFBQUwsQ0FBYztBQUFBLGlCQUFPO0FBQUVDLFlBQUFBLFFBQVEsRUFBRTtBQUFaLFdBQVA7QUFBQSxTQUFkOztBQUVBLGVBQU9ILFFBQVA7QUFDRCxPQU5JLFdBT0UsZ0JBQWdDO0FBQUEsWUFBN0JJLGFBQTZCLFFBQTdCQSxhQUE2QjtBQUFBLFlBQWRqQixPQUFjLFFBQWRBLE9BQWM7O0FBQ3JDLGNBQUtXLEtBQUwsQ0FBV08sb0JBQVgsQ0FBZ0NyQixnQkFBZ0IsR0FBR00sS0FBbkQ7O0FBRUEsMENBQWlCQSxtQ0FBakI7QUFDQSxjQUFNLElBQUlnQiwwQkFBSixDQUFvQjtBQUFFQyxVQUFBQSxNQUFNLEVBQUVwQjtBQUFWLFNBQXBCLENBQU47QUFDRCxPQVpJLENBQVA7QUFhRCxLOzs7Ozs7NkJBRVE7QUFBQSx3QkFDdUMsS0FBS1csS0FENUM7QUFBQSxVQUNDVSxZQURELGVBQ0NBLFlBREQ7QUFBQSxVQUNlQyxVQURmLGVBQ2VBLFVBRGY7QUFBQSxVQUMyQkMsT0FEM0IsZUFDMkJBLE9BRDNCO0FBQUEsVUFFQ1AsUUFGRCxHQUVjLEtBQUtRLEtBRm5CLENBRUNSLFFBRkQ7O0FBSVAsVUFBSUEsUUFBSixFQUFjO0FBQ1osZUFBTyxnQ0FBQyx3QkFBRDtBQUFVLFVBQUEsRUFBRSxFQUFFQTtBQUFkLFVBQVA7QUFDRDs7QUFFRCxhQUNFLGdDQUFDLGVBQUQ7QUFBTSxRQUFBLFFBQVEsRUFBRUssWUFBWSxDQUFDLEtBQUtJLE1BQU47QUFBNUIsU0FDRSxnQ0FBQyw0QkFBRDtBQUFXLFFBQUEsRUFBRSxFQUFFO0FBQWYsU0FDRSxnQ0FBQyxnQkFBRDtBQUNFLFFBQUEsSUFBSSxFQUFDLE1BRFA7QUFFRSxRQUFBLFNBQVMsRUFBRUMsZ0NBRmI7QUFHRSxRQUFBLFdBQVcsRUFBRSxvQkFIZjtBQUlFLFFBQUEsSUFBSSxFQUFDLE1BSlA7QUFLRSxRQUFBLFFBQVEsRUFBRSxDQUxaO0FBTUUsUUFBQSxVQUFVLEVBQUUsQ0FOZDtBQU9FLFFBQUEsVUFBVSxFQUFFO0FBUGQsUUFERixDQURGLEVBYUUsZ0NBQUMsZ0JBQUQ7QUFBTSxRQUFBLE9BQU8sRUFBRSxlQUFmO0FBQWdDLFFBQUEsRUFBRSxFQUFFO0FBQXBDLDhFQWJGLEVBaUJFLGdDQUFDLGVBQUQ7QUFBSyxRQUFBLEVBQUUsRUFBRTtBQUFULFNBQ0UsZ0NBQUMsa0JBQUQ7QUFBTyxRQUFBLEtBQUssRUFBRUM7QUFBZCxTQUNHLGlCQUF1QjtBQUFBLFlBQXBCQyxPQUFvQixTQUFwQkEsT0FBb0I7QUFBQSxZQUFYckIsSUFBVyxTQUFYQSxJQUFXO0FBQ3RCLGVBQ0UsZ0NBQUMsZ0JBQUQ7QUFDRSxVQUFBLFNBQVMsRUFBRXFCLE9BRGI7QUFFRSxVQUFBLElBQUksRUFBRSxVQUZSO0FBR0UsVUFBQSxTQUFTLEVBQUVDLDBCQUhiO0FBSUUsVUFBQSxJQUFJLEVBQUUsTUFKUjtBQUtFLFVBQUEsUUFBUSxFQUFFLE1BTFo7QUFNRSxVQUFBLFFBQVEsRUFBRSxJQU5aO0FBT0UsVUFBQSxPQUFPLEVBQ0x0QixJQUFJLElBQ0pBLElBQUksQ0FBQ3VCLFFBREwsSUFFQXZCLElBQUksQ0FBQ3VCLFFBQUwsQ0FBY0MsR0FBZCxDQUFrQixVQUFBQyxJQUFJO0FBQUEsbUJBQUs7QUFDekJDLGNBQUFBLEVBQUUsRUFBRUQsSUFBSSxDQUFDQyxFQURnQjtBQUV6QkMsY0FBQUEsSUFBSSxZQUFLRixJQUFJLENBQUNHLFNBQVYsY0FBdUJILElBQUksQ0FBQ0ksUUFBNUIsY0FBd0NKLElBQUksQ0FBQ0ssVUFBN0M7QUFGcUIsYUFBTDtBQUFBLFdBQXRCO0FBVkosVUFERjtBQWtCRCxPQXBCSCxDQURGLENBakJGLEVBMENFLGdDQUFDLGVBQUQ7QUFBSyxRQUFBLEVBQUUsRUFBRTtBQUFULFNBQ0UsZ0NBQUMsZ0JBQUQ7QUFBTyxRQUFBLFNBQVMsRUFBRUMsMEJBQWxCO0FBQWdDLFFBQUEsSUFBSSxFQUFFO0FBQXRDLFNBQ0UsZ0NBQUMsZ0JBQUQ7QUFBTSxRQUFBLFVBQVUsRUFBRSxZQUFsQjtBQUFnQyxRQUFBLFFBQVEsRUFBRSxDQUExQztBQUE2QyxRQUFBLFVBQVUsRUFBRSxDQUF6RDtBQUE0RCxRQUFBLEtBQUssRUFBRSxTQUFuRTtBQUE4RSxRQUFBLEVBQUUsRUFBRTtBQUFsRiw0SUFERixDQURGLENBMUNGLEVBa0RFLGdDQUFDLDJCQUFEO0FBQ0UsUUFBQSxJQUFJLEVBQUMsUUFEUDtBQUVFLFFBQUEsT0FBTyxFQUFFLE9BRlg7QUFHRSxRQUFBLElBQUksRUFBRSxRQUhSO0FBSUUsUUFBQSxRQUFRLEVBQUUscUJBSlo7QUFLRSxRQUFBLFFBQVEsRUFBRSx1QkFMWjtBQU1FLFFBQUEsRUFBRSxFQUFFLENBTk47QUFPRSxRQUFBLFFBQVEsRUFBRWhCLFVBQVUsSUFBSUMsT0FQMUI7QUFRRSxRQUFBLEtBQUssRUFBRSxNQVJUO0FBU0UsUUFBQSxTQUFTLEVBQUU7QUFUYixRQWxERixDQURGO0FBZ0VEOzs7d0JBOUZrQjtBQUNqQixhQUFPO0FBQUVQLFFBQUFBLFFBQVEsRUFBRTtBQUFaLE9BQVA7QUFDRDs7O0VBZnNDdUIsZ0I7OztpQ0FBNUJuQyxtQjtBQUVUaUIsRUFBQUEsWUFBWSxFQUFFbUIsc0JBQVVDLEk7QUFDeEJsQixFQUFBQSxPQUFPLEVBQUVpQixzQkFBVUUsSTtBQUNuQkMsRUFBQUEsRUFBRSxFQUFFSCxzQkFBVUksTTtBQUNkMUIsRUFBQUEsb0JBQW9CLEVBQUVzQixzQkFBVUMsSTtBQUNoQzNCLEVBQUFBLHNCQUFzQixFQUFFMEIsc0JBQVVDLEk7QUFDbENuQixFQUFBQSxVQUFVLEVBQUVrQixzQkFBVUU7R0FDbkJHLDRCO0FBc0dQLDhCQUFBekMsbUJBQW1CLEdBQUcsMEJBQVEwQyxtQ0FBUixFQUFpQztBQUNyRFosRUFBQUEsSUFBSSxFQUFFO0FBRCtDLENBQWpDLEVBRW5COUIsbUJBRm1CLENBQXRCO0FBSUEsOEJBQUFBLG1CQUFtQixHQUFHLHlCQUNwQixVQUFBb0IsS0FBSztBQUFBLFNBQUs7QUFDUnVCLElBQUFBLE1BQU0sRUFBRSw4QkFBYyxxQkFBZCxFQUFxQ3ZCLEtBQXJDO0FBREEsR0FBTDtBQUFBLENBRGUsRUFJcEIsVUFBQXdCLFFBQVE7QUFBQSxTQUFLO0FBQ1hsQyxJQUFBQSxzQkFBc0IsRUFBRSxnQ0FBQWQsT0FBTztBQUFBLGFBQUlnRCxRQUFRLENBQUMsMkNBQVFoRCxPQUFSLENBQUQsQ0FBWjtBQUFBLEtBRHBCO0FBRVhrQixJQUFBQSxvQkFBb0IsRUFBRSw4QkFBQWxCLE9BQU87QUFBQSxhQUFJZ0QsUUFBUSxDQUFDLHlDQUFNaEQsT0FBTixDQUFELENBQVo7QUFBQTtBQUZsQixHQUFMO0FBQUEsQ0FKWSxFQVFwQkksbUJBUm9CLENBQXRCO0FBVUEsOEJBQUFBLG1CQUFtQixHQUFHLDBCQUFVO0FBQzlCNkMsRUFBQUEsSUFBSSxFQUFFO0FBRHdCLENBQVYsRUFFbkI3QyxtQkFGbUIsQ0FBdEI7ZUFJZUEsbUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xyXG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAncmVhY3QtcmVkdXgnO1xyXG5pbXBvcnQgeyBncmFwaHFsLCBRdWVyeSB9IGZyb20gJ3JlYWN0LWFwb2xsbyc7XHJcbmltcG9ydCB7IHN1Y2Nlc3MsIGVycm9yIH0gZnJvbSAncmVhY3Qtbm90aWZpY2F0aW9uLXN5c3RlbS1yZWR1eCc7XHJcbmltcG9ydCB7IEZpZWxkLCByZWR1eEZvcm0sIFN1Ym1pc3Npb25FcnJvciwgRm9ybSwgRmllbGRBcnJheSwgZ2V0Rm9ybVZhbHVlcyB9IGZyb20gJ3JlZHV4LWZvcm0nO1xyXG5pbXBvcnQgVXNlckxpc3RRdWVyeSBmcm9tICcuL1VzZXJMaXN0UXVlcnkuZ3JhcGhxbCc7XHJcbmltcG9ydCB7IFJlZGlyZWN0IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XHJcblxyXG4vKipWaWV3ICovXHJcbmltcG9ydCBUZXh0RmllbGRXaXRoVG9vbHRpcCBmcm9tICdAbGliL3VpL1RleHRGaWVsZFdpdGhUb29sdGlwL1RleHRGaWVsZFdpdGhUb29sdGlwJztcclxuaW1wb3J0IEJ1dHRvbldpdGhJbWFnZSBmcm9tICdAbGliL3VpL0J1dHRvbldpdGhJbWFnZS9CdXR0b25XaXRoSW1hZ2UnO1xyXG5pbXBvcnQgVGV4dCBmcm9tICdAbGliL3VpL1RleHQvVGV4dCc7XHJcbmltcG9ydCBCb3ggZnJvbSAnQGxpYi91aS9Cb3gvQm94JztcclxuaW1wb3J0IFRleHRGaWVsZEFycmF5IGZyb20gJ0BsaWIvdWkvVGV4dEZpZWxkQXJyYXkvVGV4dEZpZWxkQXJyYXknO1xyXG5pbXBvcnQgeyBDaGVja2JveEJhc2UgfSBmcm9tICdAbGliL3VpL0NoZWNrYm94QmFzZS9DaGVja2JveEJhc2UnO1xyXG5cclxuLyoqSW1hZ2UgKi9cclxuaW1wb3J0IHsgU3ZnU2F2ZSB9IGZyb20gJ0BsaWIvdWkvSWNvbnMvU3ZnU2F2ZSc7XHJcblxyXG4vKipQcm9wVHlwZXMgKi9cclxuaW1wb3J0IHsgZm9ybVByb3BUeXBlcyB9IGZyb20gJy4uLy4uLy4uLy4uL3Byb3BUeXBlcy9Gb3Jtcy9Gb3JtUHJvcFR5cGVzJztcclxuXHJcbi8qKiBHcmFwaHFsIHNjaGVtYSAqL1xyXG5pbXBvcnQgUHJvamVjdFNldHRpbmdzTXV0YXRpb24gZnJvbSAnLi9Qcm9qZWN0U2V0dGluZ3NNdXRhdGlvbi5ncmFwaHFsJztcclxuaW1wb3J0IHsgY2FwdHVyZUV4Y2VwdGlvbiB9IGZyb20gJy4uLy4uLy4uLy4uL2hvY3Mvd2l0aFNlbnRyeS93aXRoU2VudHJ5JztcclxuXHJcbi8qKiBDU1Mgc3R5bGUgaW4gb3RoZXIgQ29tcG9uZW50ICovXHJcbmltcG9ydCB7IEJveFN0eWxlZCB9IGZyb20gJy4uL0Zvcm1Qcm9qZWN0Q3JlYXRlL0Zvcm1Qcm9qZWN0Q3JlYXRlJztcclxuXHJcbmNvbnN0IG5vdGlmaWNhdGlvbk9wdHMgPSAoKSA9PiAoe1xyXG4gIHN1Y2Nlc3M6IHtcclxuICAgIHRpdGxlOiAn0J3QsNGB0YLRgNC+0LnQutC4INC/0YDQvtC10LrRgtCwINGD0YHQv9C10YjQvdC+INC+0LHQvdC+0LLQu9C10L3RiycsXHJcbiAgICBtZXNzYWdlOiAn0J3QsNGB0YLRgNC+0LnQutC4INC/0YDQvtC10LrRgtCwINGD0YHQv9C10YjQvdC+INC+0LHQvdC+0LLQu9C10L3RiycsXHJcbiAgICBwb3NpdGlvbjogJ3RyJyxcclxuICAgIGF1dG9EaXNtaXNzOiAyLFxyXG4gIH0sXHJcbiAgZXJyb3I6IHtcclxuICAgIHRpdGxlOiAn0J3QsNGB0YLRgNC+0LnQutC4INC/0YDQvtC10LrRgtCwINC90LUg0L7QsdC90L7QstC70LXQvdGLJyxcclxuICAgIG1lc3NhZ2U6ICfQndCw0YHRgtGA0L7QudC60Lgg0L/RgNC+0LXQutGC0LAg0L3QtSDQvtCx0L3QvtCy0LvQtdC90YsnLFxyXG4gICAgcG9zaXRpb246ICd0cicsXHJcbiAgICBhdXRvRGlzbWlzczogMixcclxuICB9LFxyXG59KTtcclxuXHJcbmV4cG9ydCBjbGFzcyBGb3JtUHJvamVjdFNldHRpbmdzIGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xyXG4gICAgaGFuZGxlU3VibWl0OiBQcm9wVHlwZXMuZnVuYyxcclxuICAgIGludmFsaWQ6IFByb3BUeXBlcy5ib29sLFxyXG4gICAgbWI6IFByb3BUeXBlcy5zdHJpbmcsXHJcbiAgICBzZXROb3RpZmljYXRpb25FcnJvcjogUHJvcFR5cGVzLmZ1bmMsXHJcbiAgICBzZXROb3RpZmljYXRpb25TdWNjZXNzOiBQcm9wVHlwZXMuZnVuYyxcclxuICAgIHN1Ym1pdHRpbmc6IFByb3BUeXBlcy5ib29sLFxyXG4gICAgLi4uZm9ybVByb3BUeXBlcyxcclxuICB9O1xyXG5cclxuICBzdGF0ZSA9IHRoaXMuaW5pdGlhbFN0YXRlO1xyXG5cclxuICBnZXQgaW5pdGlhbFN0YXRlKCkge1xyXG4gICAgcmV0dXJuIHsgcmVkaXJlY3Q6IG51bGwgfTtcclxuICB9XHJcblxyXG4gIHN1Ym1pdCA9IHZhbHVlID0+IHtcclxuICAgIGNvbnN0IGRhdGEgPSB7IHZhcmlhYmxlczogT2JqZWN0LmFzc2lnbih7fSwgdmFsdWUpIH07XHJcblxyXG4gICAgcmV0dXJuIHRoaXMucHJvcHNbJ0BhcG9sbG8vdXBkYXRlJ10oZGF0YSlcclxuICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xyXG4gICAgICAgIHRoaXMucHJvcHMuc2V0Tm90aWZpY2F0aW9uU3VjY2Vzcyhub3RpZmljYXRpb25PcHRzKCkuc3VjY2Vzcyk7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSgoKSA9PiAoeyByZWRpcmVjdDogJy9hcHAvcHJvamVjdC1saXN0JyB9KSk7XHJcblxyXG4gICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKCh7IGdyYXBoUUxFcnJvcnMsIG1lc3NhZ2UgfSkgPT4ge1xyXG4gICAgICAgIHRoaXMucHJvcHMuc2V0Tm90aWZpY2F0aW9uRXJyb3Iobm90aWZpY2F0aW9uT3B0cygpLmVycm9yKTtcclxuXHJcbiAgICAgICAgY2FwdHVyZUV4Y2VwdGlvbihlcnJvcik7XHJcbiAgICAgICAgdGhyb3cgbmV3IFN1Ym1pc3Npb25FcnJvcih7IF9lcnJvcjogbWVzc2FnZSB9KTtcclxuICAgICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgeyBoYW5kbGVTdWJtaXQsIHN1Ym1pdHRpbmcsIGludmFsaWQgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7IHJlZGlyZWN0IH0gPSB0aGlzLnN0YXRlO1xyXG5cclxuICAgIGlmIChyZWRpcmVjdCkge1xyXG4gICAgICByZXR1cm4gPFJlZGlyZWN0IHRvPXtyZWRpcmVjdH0gLz47XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIChcclxuICAgICAgPEZvcm0gb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdCh0aGlzLnN1Ym1pdCl9PlxyXG4gICAgICAgIDxCb3hTdHlsZWQgbWI9ezE2fT5cclxuICAgICAgICAgIDxGaWVsZFxyXG4gICAgICAgICAgICBuYW1lPVwibmFtZVwiXHJcbiAgICAgICAgICAgIGNvbXBvbmVudD17VGV4dEZpZWxkV2l0aFRvb2x0aXB9XHJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPXsn0J3QsNC30LLQsNC90LjQtSDQtNC+0LrRg9C80LXQvdGC0LAnfVxyXG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgIGZvbnRTaXplPXs2fVxyXG4gICAgICAgICAgICBsaW5lSGVpZ2h0PXs4fVxyXG4gICAgICAgICAgICBmb250RmFtaWx5PXsnc2Vjb25kYXJ5J31cclxuICAgICAgICAgIC8+XHJcbiAgICAgICAgPC9Cb3hTdHlsZWQ+XHJcblxyXG4gICAgICAgIDxUZXh0IHZhcmlhbnQ9eydkb2N1bWVudFRpdGxlJ30gbWI9ezR9PlxyXG4gICAgICAgICAg0KHQvtCz0LvQsNGB0YPRjtGJ0LjQtVxyXG4gICAgICAgIDwvVGV4dD5cclxuXHJcbiAgICAgICAgPEJveCBtYj17JzQ1cHgnfT5cclxuICAgICAgICAgIDxRdWVyeSBxdWVyeT17VXNlckxpc3RRdWVyeX0+XHJcbiAgICAgICAgICAgIHsoeyBsb2FkaW5nLCBkYXRhIH0pID0+IHtcclxuICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgPEZpZWxkXHJcbiAgICAgICAgICAgICAgICAgIGlzTG9hZGluZz17bG9hZGluZ31cclxuICAgICAgICAgICAgICAgICAgbmFtZT17J3BhcnRuZXJzJ31cclxuICAgICAgICAgICAgICAgICAgY29tcG9uZW50PXtUZXh0RmllbGRBcnJheX1cclxuICAgICAgICAgICAgICAgICAgdHlwZT17J3RleHQnfVxyXG4gICAgICAgICAgICAgICAgICBsYWJlbEtleT17J25hbWUnfVxyXG4gICAgICAgICAgICAgICAgICB2YWx1ZUtleT17J2lkJ31cclxuICAgICAgICAgICAgICAgICAgb3B0aW9ucz17XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudXNlcmxpc3QgJiZcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnVzZXJsaXN0Lm1hcChpdGVtID0+ICh7XHJcbiAgICAgICAgICAgICAgICAgICAgICBpZDogaXRlbS5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGAke2l0ZW0uZmlyc3RuYW1lfSAke2l0ZW0ubGFzdG5hbWV9ICR7aXRlbS5wYXRyb255bWljfWAsXHJcbiAgICAgICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfX1cclxuICAgICAgICAgIDwvUXVlcnk+XHJcbiAgICAgICAgPC9Cb3g+XHJcblxyXG4gICAgICAgIDxCb3ggbWI9eyc5MHB4J30+XHJcbiAgICAgICAgICA8RmllbGQgY29tcG9uZW50PXtDaGVja2JveEJhc2V9IG5hbWU9eydpc1RlbXBsYXRlJ30+XHJcbiAgICAgICAgICAgIDxUZXh0IGZvbnRGYW1pbHk9eydwcmltYXJ5MzAwJ30gZm9udFNpemU9ezZ9IGxpbmVIZWlnaHQ9ezh9IGNvbG9yPXsnY29sb3IxMSd9IG1sPXsyMH0+XHJcbiAgICAgICAgICAgICAg0KHQtNC10LvQsNGC0Ywg0L/RgNC+0LXQutGCINGI0LDQsdC70L7QvdC+0LxcclxuICAgICAgICAgICAgPC9UZXh0PlxyXG4gICAgICAgICAgPC9GaWVsZD5cclxuICAgICAgICA8L0JveD5cclxuXHJcbiAgICAgICAgPEJ1dHRvbldpdGhJbWFnZVxyXG4gICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXHJcbiAgICAgICAgICB2YXJpYW50PXsnbGFyZ2UnfVxyXG4gICAgICAgICAgc2l6ZT17J21lZGl1bSd9XHJcbiAgICAgICAgICBjaGlsZHJlbj17J9Ch0L7RhdGA0LDQvdC40YLRjCDQvdCw0YHRgtGA0L7QudC60LgnfVxyXG4gICAgICAgICAgbGVmdEljb249e1N2Z1NhdmUoKX1cclxuICAgICAgICAgIG1yPXs5fVxyXG4gICAgICAgICAgZGlzYWJsZWQ9e3N1Ym1pdHRpbmcgfHwgaW52YWxpZH1cclxuICAgICAgICAgIHdpZHRoPXsnMTAwJSd9XHJcbiAgICAgICAgICB3aWR0aEljb249eycxNnB4J31cclxuICAgICAgICAvPlxyXG4gICAgICA8L0Zvcm0+XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuRm9ybVByb2plY3RTZXR0aW5ncyA9IGdyYXBocWwoUHJvamVjdFNldHRpbmdzTXV0YXRpb24sIHtcclxuICBuYW1lOiAnQGFwb2xsby91cGRhdGUnLFxyXG59KShGb3JtUHJvamVjdFNldHRpbmdzKTtcclxuXHJcbkZvcm1Qcm9qZWN0U2V0dGluZ3MgPSBjb25uZWN0KFxyXG4gIHN0YXRlID0+ICh7XHJcbiAgICB2YWx1ZXM6IGdldEZvcm1WYWx1ZXMoJ0Zvcm1Qcm9qZWN0U2V0dGluZ3MnKShzdGF0ZSksXHJcbiAgfSksXHJcbiAgZGlzcGF0Y2ggPT4gKHtcclxuICAgIHNldE5vdGlmaWNhdGlvblN1Y2Nlc3M6IG1lc3NhZ2UgPT4gZGlzcGF0Y2goc3VjY2VzcyhtZXNzYWdlKSksXHJcbiAgICBzZXROb3RpZmljYXRpb25FcnJvcjogbWVzc2FnZSA9PiBkaXNwYXRjaChlcnJvcihtZXNzYWdlKSksXHJcbiAgfSksXHJcbikoRm9ybVByb2plY3RTZXR0aW5ncyk7XHJcblxyXG5Gb3JtUHJvamVjdFNldHRpbmdzID0gcmVkdXhGb3JtKHtcclxuICBmb3JtOiAnRm9ybVByb2plY3RTZXR0aW5ncycsXHJcbn0pKEZvcm1Qcm9qZWN0U2V0dGluZ3MpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVByb2plY3RTZXR0aW5ncztcclxuIl19